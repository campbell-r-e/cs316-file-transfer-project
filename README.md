based on code by Aidan Bensch.
